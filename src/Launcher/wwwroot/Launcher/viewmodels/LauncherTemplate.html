<!doctype html>
<html>
<head>

    <title>Colab</title>
    <link rel="shortcut icon" href="/Launcher/favicon.ico" />

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no">

    <!-- iOS -->
    <link rel="apple-touch-icon" href="/Launcher/favicon.ico" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />
    <meta name="apple-mobile-web-app-title" content="Colab">

    <!-- Import Polymer platform -->
    <script src="/sys/webcomponentsjs/webcomponents.js"></script>
    <script>
      window.Polymer = window.Polymer || {};
      window.Polymer.dom = "shadow";
      //Raven.config('https://25d8d13cb3474332b051f3a8c8c3e647@app.getsentry.com/65046').install();
    </script>

 <link rel="import" href="/sys/polymer/polymer.html" />

    <!-- Import Starcounter specific components -->
    <link rel="import" href="/sys/starcounter.html" />
    <link rel="import" href="/sys/starcounter-debug-aid/src/starcounter-debug-aid.html" />

    <!-- Import our elements -->
    <link rel="import" href="/Launcher/elements/launcher-launchpad/launcher-launchpad.html" />
    <link rel="import" href="/Launcher/elements/launcher-hot-key/launcher-hot-key.html" />
    <link rel="import" href="/Launcher/elements/launcher-search/launcher-search.html" />
    <link rel="import" href="/Launcher/elements/launcher-search-input/launcher-search-input.html" />
    <link rel="import" href="/Launcher/elements/launcher-search-result/launcher-search-result.html" />
    <link rel="import" href="/Launcher/elements/launcher-menu/launcher-menu.html" />
    <link rel="import" href="/co-common/elements/app/co-logo.html">
    <link rel="import" href="/Launcher/elements/launcher-display-router/launcher-display-router.html" />
	  <link rel="import" href="/Launcher/elements/puppet-bind-notifier/puppet-bind-notifier.html" />
    <link rel="import" href="/sys/starcounter-include/starcounter-include.html" />
    <link rel="import" href="/Launcher/elements/co-layout/co-launcher.html" />
    <link rel="import" href="/Launcher/elements/co-layout/co-layout-multiview.html" />
    <link rel="import" href="/Launcher/elements/co-layout/co-title.html" />
    <link rel="import" href="/Launcher/elements/co-launcher-redirect/co-launcher-redirect.html" />

    <!-- Disable untill migrated to Polymer1 <link rel="import" href="/sys/console-log/console-log.html" /> -->

    <link rel="import" href="/sys/imported-template/imported-template.html" />


    <!--<link href='//fonts.googleapis.com/css?family=Lato&subset=latin,latin-ext' rel='stylesheet' type='text/css'>-->
    <link href='//fonts.googleapis.com/css?family=Roboto' rel='stylesheet' type='text/css'>
    <!--<link rel="stylesheet" type="text/css" href="/sys/font-awesome/css/font-awesome.css">-->
    <!--<link rel="stylesheet" href="/sys/font-awesome/css/font-awesome.css">-->
    <!-- Style sheets -->
    <!--<link rel="import" href="/sys/bootstrap.html" />-->
    <link rel="stylesheet" href="/Launcher/css/style.css" />

    <link rel="manifest" href="/webapp/manifest.json">
    <style>

      /* Hack to avoid changing font name everywhere */
      /* cyrillic-ext */
      @font-face {
        font-family: 'Lato';
        font-style: normal;
        font-weight: 400;
        src: local('Roboto'), local('Roboto-Regular'), url(//fonts.gstatic.com/s/roboto/v15/sTdaA6j0Psb920Vjv-mrzH-_kf6ByYO6CLYdB4HQE-Y.woff2) format('woff2');
        unicode-range: U+0460-052F, U+20B4, U+2DE0-2DFF, U+A640-A69F;
      }
      /* cyrillic */
      @font-face {
        font-family: 'Lato';
        font-style: normal;
        font-weight: 400;
        src: local('Roboto'), local('Roboto-Regular'), url(//fonts.gstatic.com/s/roboto/v15/uYECMKoHcO9x1wdmbyHIm3-_kf6ByYO6CLYdB4HQE-Y.woff2) format('woff2');
        unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
      }
      /* greek-ext */
      @font-face {
        font-family: 'Lato';
        font-style: normal;
        font-weight: 400;
        src: local('Roboto'), local('Roboto-Regular'), url(//fonts.gstatic.com/s/roboto/v15/tnj4SB6DNbdaQnsM8CFqBX-_kf6ByYO6CLYdB4HQE-Y.woff2) format('woff2');
        unicode-range: U+1F00-1FFF;
      }
      /* greek */
      @font-face {
        font-family: 'Lato';
        font-style: normal;
        font-weight: 400;
        src: local('Roboto'), local('Roboto-Regular'), url(//fonts.gstatic.com/s/roboto/v15/_VYFx-s824kXq_Ul2BHqYH-_kf6ByYO6CLYdB4HQE-Y.woff2) format('woff2');
        unicode-range: U+0370-03FF;
      }
      /* vietnamese */
      @font-face {
        font-family: 'Lato';
        font-style: normal;
        font-weight: 400;
        src: local('Roboto'), local('Roboto-Regular'), url(//fonts.gstatic.com/s/roboto/v15/NJ4vxlgWwWbEsv18dAhqnn-_kf6ByYO6CLYdB4HQE-Y.woff2) format('woff2');
        unicode-range: U+0102-0103, U+1EA0-1EF9, U+20AB;
      }
      /* latin-ext */
      @font-face {
        font-family: 'Lato';
        font-style: normal;
        font-weight: 400;
        src: local('Roboto'), local('Roboto-Regular'), url(//fonts.gstatic.com/s/roboto/v15/Ks_cVxiCiwUWVsFWFA3Bjn-_kf6ByYO6CLYdB4HQE-Y.woff2) format('woff2');
        unicode-range: U+0100-024F, U+1E00-1EFF, U+20A0-20AB, U+20AD-20CF, U+2C60-2C7F, U+A720-A7FF;
      }
      /* latin */
      @font-face {
        font-family: 'Lato';
        font-style: normal;
        font-weight: 400;
        src: local('Roboto'), local('Roboto-Regular'), url(//fonts.gstatic.com/s/roboto/v15/oMMgfZMQthOryQo9n22dcuvvDin1pK8aKteLpeZ5c0A.woff2) format('woff2');
        unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2212, U+2215, U+E0FF, U+EFFD, U+F000;
      }

      [main] {
        position: relative;
        display: flex;
        flex-direction: column;
        flex:1;
        display: flex;
        flex-direction: column;
      }

      [hidden] {
        visibility: hidden !important;
        display: none !important;
      }

      #workspace {
        position: relative;
        overflow: auto;
        flex:1;
      }

      launcher-search {
        margin-left: 10px;
      }

    </style>
</head>
<body is="launcher-main" class="loading">
    <div id="co-splash">
        <span id="co-splash-text">LOADING</span>
        <span id="co-splash-spinner">âš‡</span>
    </div>
    <template id="root-launcher-dom-bind" is="dom-bind">
      <co-title value="[[model.Title]]"></co-title>
      <co-launcher only-workspace="[[!model.signedIn]]" cp-auto-visible=[[model.contextpanelAutoVisible]]>
        <co-launcher-toolbar toolbar class="launcher-toolbar launcher-topbar" menu="{{model.menu}}">
          <!-- menu is built inside toolbar -->
          <launcher-search search placeholder="Search here..."  data="{{model.searchBar}}"></launcher-search>
          <template is="imported-template" content$="{{model.user.LauncherLayoutInfo.MergedHtml}}" model="{{model.user}}"></template>
        </co-launcher-toolbar>

        <div main>
          <co-layout-multiview data="{{model.contextbar}}"></co-layout-multiview>
          <div id="workspace">
            <template is="dom-repeat" items="{{model.workspaces}}">
              <starcounter-include style="height:100%" partial="{{item.Partials}}" class="workspace" visible$="{{item.ActiveWorkspace}}"></starcounter-include>
            </template>
          </div>
        </div>

        <co-layout-multiview left data="{{model.contextpanel}}"></co-layout-multiview>
        <co-layout-multiview right data="{{model.sidepanel}}"></co-layout-multiview>

      </co-launcher>

      <co-lightbox-popup></co-lightbox-popup>

      <co-launcher-redirect uri="{{model.redirect$}}"> </co-launcher-redirect>
      <paper-dialog opened="{{model.ConnectionError}}" modal="true">
            <h4>Connection error</h4>
            <p>You have been disconnected from server. Please reload page.</p>
            <div class="buttons">
                <button class="btn btn-sm btn-default" dialog-dismiss>Close</button>
                <span>&nbsp;</span>
                <button class="btn btn-sm btn-primary" dialog-confirm onclick="window.location = window.location.href;">Reload</button>
            </div>
      </paper-dialog>
    </template>
    <script>
        (function () {
            var script = document._currentScript || document.currentScript;
            var template = script.previousElementSibling;

            template.concat = function () {
                return Array.prototype.join.call(arguments, "");
            };

            template.addEventListener("dom-change", function () {
                var puppet = document.querySelector("puppet-client");

                puppet.addEventListener("connectionerror", function (e) {
                    e.detail.handled = true;
                    template.set("model.ConnectionError", true);
                });
            });

        })();
    </script>

    <puppet-client ref="root-launcher-dom-bind" ping-interval-s="60"></puppet-client>
    <starcounter-debug-aid></starcounter-debug-aid>
    <script>
        var puppet = document.getElementsByTagName("puppet-client")[0];
    </script>
  <!--  <script>
      if ('serviceWorker' in navigator) {
        console.log("Will the service worker register?");
        navigator.serviceWorker.register('/Launcher/js/service-worker.js')
          .then(function(reg){
            console.log("Yes, it did.");
          }).catch(function(err) {
            console.log("No it didn't. This happened: ", err)
          });
      }
    </script>-->
</body>
</html>
